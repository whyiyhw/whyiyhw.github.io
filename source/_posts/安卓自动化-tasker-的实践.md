---
title: '安卓自动化软件 tasker 的实践'
date: 2022-05-22 17:38:14
categories: tasker
tags: 自动打卡
---

## 安卓自动化 tasker 的实践

事情是这个样子的，出于不合理工时以及废旧安卓的再利用，我需要在不`root`的情况下进行`xxapp`的自动打卡

## 初步思路

经过`Google`与`V站`查询，大致的有这4种思路去做

- 自动化相关应用
  - `tasker`、`autojs`、`hamibot`
- 远程工具
  - `TeamViewer`
- 虚拟定位软件
- 修改 `WiFi mac` 地址

## 问题点

`xxapp` 极速打卡可能会存在的一些检测机制

- `xxapp`会定期检测实时位置
- `xxapp`会读取相关运行应用
- 另外需要注意的一点是避免打卡的时间过于固定与一致

## 实现

最终我使用 [tasker](https://tasker.joaoapps.com/download.html) 来做这件事

### 前置条件

- 因为是旧华为手机，给 `tasker` 把权限全部打开
- 电池优化相关，设置 `tasker` 不进入优化名单
- 7次点击版本号，进入开发者模式，关闭锁屏选项,开启运行 `adb` 调试
- [windows电脑端 adb 下载](https://www.xda-developers.com/install-adb-windows-macos-linux/#adbsetupwindows) ， 设置安全权限 `adb shell pm grant net.dinglisch.android.taskerm android.permission.WRITE_SECURE_SETTINGS`

### tasker 应用基础概念

在完成上述的设置之后，进入这个软件，我们目前要用的核心板块有三块，配置文件、任务与变量。

配置文件可以对任务进行编排，设置触发条件，任务指的是一系列操作的集合，而变量则可以在多个任务之间进行传递。

我们很轻松可以实现一个打开app的任务,然后app内设置极速打卡，这样我们的设想就成立了，剩下的就是完善。

### 定期检测实时位置

目前处理方式为 将手机放在公司，连接上公司的WiFi，避免虚拟定位导致人一秒钟，移动几公里的漂移问题。

### 读取相关运行应用

这也是不采用虚拟定位app 来进行打卡的原因之一，xx会扫描正在运行时的包，部分应用可能处在黑名单之中。需要在打卡之前，根据随机值，去开启一系列的应用，来模拟日常有人使用的假象。

### 不固定打卡时间

核心功能中的变量正好能处理这个事情，设置一个全局变量`%Random` 在任务中去进行随机变量的操作，再设置一个等待随机分钟的任务，记得设置的大一点，来避免总时长过于一致的尴尬，这样就算完成打卡的核心功能

### 避免节假日自动打卡

这个可以自己写shell但是没必要，手机设置，自动开关机，智能跳过节假日就好~

### 打卡后的通知

既然手机放在公司，能连上WiFi就可以通过网络来通知，注册一个企业微信，再跟个人微信绑定，创建一个专门用于通知的应用，简单的编写一个通知程序，跑在自己的服务器上，在任务的最后通过 http来调用这个程序，将消息下发到关联微信就好~

## 总结

不root的情况下，安卓自动化应用确实是比较弱，这个应用能干的事情也远不止打打卡，后续如果遇到了合适的场景，再去试试它的其他功能，886~
